{
  "openapi": "3.1.0",
  "info": {
    "title": "Frank Bot",
    "version": "0.5.0",
    "description": "Personal assistant for Google Calendar, Contacts, and Swarm location history."
  },
  "servers": [
    {
      "url": "http://localhost:8000"
    }
  ],
  "paths": {
    "/actions/hello": {
      "get": {
        "operationId": "sayHello",
        "summary": "Quick greeting",
        "parameters": [
          {
            "in": "query",
            "name": "name",
            "schema": {
              "type": "string"
            },
            "required": false,
            "description": "Optional name to include in the greeting."
          }
        ],
        "responses": {
          "200": {
            "description": "Greeting response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HelloWorldResponse"
                }
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/calendar/events": {
      "get": {
        "operationId": "listCalendarEvents",
        "summary": "List upcoming calendar events (read-only)",
        "parameters": [
          {
            "in": "query",
            "name": "day",
            "schema": {"type": "string"},
            "required": false,
            "description": "ISO date (YYYY-MM-DD) to list events for that day."
          },
          {
            "in": "query",
            "name": "time_min",
            "schema": {"type": "string"},
            "required": false,
            "description": "Lower bound (inclusive) in RFC3339/ISO8601 format."
          },
          {
            "in": "query",
            "name": "time_max",
            "schema": {"type": "string"},
            "required": false,
            "description": "Upper bound (exclusive) in RFC3339/ISO8601 format."
          },
          {
            "in": "query",
            "name": "max_results",
            "schema": {"type": "integer"},
            "required": false,
            "description": "Maximum events to return (1-50)."
          },
          {
            "in": "query",
            "name": "time_zone",
            "schema": {"type": "string"},
            "required": false,
            "description": "IANA timezone name."
          },
          {
            "in": "query",
            "name": "calendar_id",
            "schema": {"type": "string"},
            "required": false,
            "description": "Specific calendar ID."
          },
          {
            "in": "query",
            "name": "calendar_name",
            "schema": {"type": "string"},
            "required": false,
            "description": "Display name to resolve a calendar."
          }
        ],
        "responses": {
          "200": {
            "description": "List of calendar events.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ListCalendarEventsResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/calendar/schedule": {
      "get": {
        "operationId": "scheduleTime",
        "summary": "Add a time block to your calendar",
        "parameters": [
          {
            "in": "query",
            "name": "summary",
            "schema": {"type": "string"},
            "required": true,
            "description": "Title for the calendar entry."
          },
          {
            "in": "query",
            "name": "start",
            "schema": {"type": "string"},
            "required": true,
            "description": "Start time in ISO8601 format."
          },
          {
            "in": "query",
            "name": "end",
            "schema": {"type": "string"},
            "required": true,
            "description": "End time in ISO8601 format."
          },
          {
            "in": "query",
            "name": "description",
            "schema": {"type": "string"},
            "required": false,
            "description": "Optional notes or description."
          },
          {
            "in": "query",
            "name": "location",
            "schema": {"type": "string"},
            "required": false,
            "description": "Location or address for the event (e.g., 'Nerdvana, Frisco, TX' or '123 Main St')."
          },
          {
            "in": "query",
            "name": "attendees",
            "schema": {"type": "string"},
            "required": false,
            "description": "Comma-separated email addresses for attendees."
          },
          {
            "in": "query",
            "name": "time_zone",
            "schema": {"type": "string"},
            "required": false,
            "description": "IANA timezone (defaults to your location)."
          },
          {
            "in": "query",
            "name": "calendar_id",
            "schema": {"type": "string"},
            "required": false,
            "description": "Specific calendar ID."
          },
          {
            "in": "query",
            "name": "calendar_name",
            "schema": {"type": "string"},
            "required": false,
            "description": "Calendar name to use."
          }
        ],
        "responses": {
          "200": {
            "description": "Calendar entry details.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/CreateCalendarEventResponse"}
              }
            }
          },
          "400": {
            "description": "Invalid request.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/calendar/calendars": {
      "get": {
        "operationId": "listCalendars",
        "summary": "List available calendars (read-only)",
        "parameters": [
          {
            "in": "query",
            "name": "include_access_role",
            "schema": {"type": "boolean"},
            "required": false,
            "description": "Include accessRole metadata when true."
          },
          {
            "in": "query",
            "name": "primary_only",
            "schema": {"type": "boolean"},
            "required": false,
            "description": "Return only the primary calendar when true."
          }
        ],
        "responses": {
          "200": {
            "description": "List of calendars.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ListCalendarsResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/contacts/search": {
      "get": {
        "operationId": "searchContacts",
        "summary": "Search Google Contacts (read-only)",
        "parameters": [
          {
            "in": "query",
            "name": "query",
            "schema": {"type": "string"},
            "required": true,
            "description": "Search text (names, emails, or phone numbers)."
          },
          {
            "in": "query",
            "name": "max_results",
            "schema": {"type": "integer"},
            "required": false,
            "description": "Maximum results to return."
          }
        ],
        "responses": {
          "200": {
            "description": "Search results.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/SearchContactsResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/swarm/self": {
      "get": {
        "operationId": "listMySwarmCheckins",
        "summary": "List your Swarm check-ins with filtering (read-only). Use to answer 'What restaurant did Jimmy and I go to in 2024?' or 'Show check-ins with Linda'.",
        "parameters": [
          {
            "in": "query",
            "name": "max_results",
            "schema": {"type": "integer"},
            "required": false,
            "description": "Number of check-ins to return (default 10, max 250)."
          },
          {
            "in": "query",
            "name": "year",
            "schema": {"type": "integer"},
            "required": false,
            "description": "Filter to check-ins from a specific year (e.g., 2024)."
          },
          {
            "in": "query",
            "name": "after_date",
            "schema": {"type": "string"},
            "required": false,
            "description": "Filter to check-ins after this date (YYYY-MM-DD)."
          },
          {
            "in": "query",
            "name": "before_date",
            "schema": {"type": "string"},
            "required": false,
            "description": "Filter to check-ins before this date (YYYY-MM-DD)."
          },
          {
            "in": "query",
            "name": "with_companion",
            "schema": {"type": "string"},
            "required": false,
            "description": "Filter to check-ins with this person (name). Comma-separate for multiple (e.g., 'lauren, ekaterina'). Uses fuzzy matching for typos."
          },
          {
            "in": "query",
            "name": "companion_match",
            "schema": {"type": "string", "enum": ["any", "all"]},
            "required": false,
            "description": "'any' (default) = OR, matches if ANY companion present; 'all' = AND, requires ALL companions."
          },
          {
            "in": "query",
            "name": "only_with_companions",
            "schema": {"type": "boolean"},
            "required": false,
            "description": "If true, only return check-ins where you were with someone."
          },
          {
            "in": "query",
            "name": "category",
            "schema": {"type": "string"},
            "required": false,
            "description": "Filter by venue category (e.g., 'restaurant', 'coffee', 'bar')."
          },
          {
            "in": "query",
            "name": "has_photos",
            "schema": {"type": "boolean"},
            "required": false,
            "description": "If true, only return check-ins that have photos."
          },
          {
            "in": "query",
            "name": "include_photos",
            "schema": {"type": "boolean"},
            "required": false,
            "description": "If true, include photo URLs in the response for rendering."
          }
        ],
        "responses": {
          "200": {
            "description": "Your Swarm check-ins matching the filters.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/SwarmMyCheckinsResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/me/time": {
      "get": {
        "operationId": "getMyTime",
        "summary": "Get current local time based on your location (read-only)",
        "responses": {
          "200": {
            "description": "Current local time information.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/CurrentTimeResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/server/version": {
      "get": {
        "operationId": "getServerVersion",
        "summary": "Get server uptime info (read-only)",
        "responses": {
          "200": {
            "description": "Server start time and uptime.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ServerVersionResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    }
  },
  "components": {
    "schemas": {
      "HelloWorldResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "name": {"type": "string"}
        },
        "required": ["message", "name"]
      },
      "CalendarDescriptor": {
        "type": "object",
        "properties": {
          "id": {"type": "string"},
          "label": {"type": "string"}
        }
      },
      "TimeWindow": {
        "type": "object",
        "properties": {
          "time_min": {"type": "string"},
          "time_max": {"type": "string"},
          "time_zone": {"type": "string"}
        }
      },
      "CalendarEvent": {
        "type": "object",
        "description": "Google Calendar event.",
        "properties": {
          "id": {"type": "string"},
          "summary": {"type": "string"},
          "description": {"type": "string"},
          "location": {"type": "string"},
          "htmlLink": {"type": "string", "format": "uri"},
          "start": {"type": "object", "additionalProperties": true},
          "end": {"type": "object", "additionalProperties": true},
          "attendees": {
            "type": "array",
            "items": {"type": "object", "additionalProperties": true}
          }
        },
        "additionalProperties": true
      },
      "ListCalendarEventsResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "calendar": {"$ref": "#/components/schemas/CalendarDescriptor"},
          "time_window": {"$ref": "#/components/schemas/TimeWindow"},
          "count": {"type": "integer"},
          "events": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/CalendarEvent"}
          }
        },
        "required": ["message", "calendar", "time_window", "count", "events"]
      },
      "CreateCalendarEventRequest": {
        "type": "object",
        "properties": {
          "summary": {"type": "string"},
          "start": {"type": "string", "description": "Start time in ISO8601 format."},
          "end": {"type": "string", "description": "End time in ISO8601 format."},
          "attendees": {
            "type": "array",
            "items": {"type": "string"},
            "description": "Email addresses for attendees."
          },
          "description": {"type": "string"},
          "location": {"type": "string", "description": "Location or address for the event."},
          "time_zone": {"type": "string"},
          "calendar_id": {"type": "string"},
          "calendar_name": {"type": "string"}
        },
        "required": ["summary", "start", "end"]
      },
      "CreateCalendarEventResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "calendar": {"$ref": "#/components/schemas/CalendarDescriptor"},
          "event": {"$ref": "#/components/schemas/CalendarEvent"}
        },
        "required": ["message", "calendar", "event"]
      },
      "CalendarSummary": {
        "type": "object",
        "properties": {
          "id": {"type": "string"},
          "summary": {"type": "string"},
          "timeZone": {"type": "string"},
          "primary": {"type": "boolean"},
          "accessRole": {"type": "string"}
        }
      },
      "ListCalendarsResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "count": {"type": "integer"},
          "calendars": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/CalendarSummary"}
          }
        },
        "required": ["message", "count", "calendars"]
      },
      "ContactResult": {
        "type": "object",
        "properties": {
          "resource_name": {"type": "string"},
          "display_name": {"type": "string"},
          "emails": {"type": "array", "items": {"type": "string"}},
          "phones": {"type": "array", "items": {"type": "string"}}
        }
      },
      "SearchContactsResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "query": {"type": "string"},
          "count": {"type": "integer"},
          "contacts": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/ContactResult"}
          }
        },
        "required": ["message", "query", "count", "contacts"]
      },
      "SwarmVenue": {
        "type": "object",
        "properties": {
          "name": {"type": "string"},
          "city": {"type": "string"},
          "state": {"type": "string"},
          "country": {"type": "string"},
          "latitude": {"type": "number"},
          "longitude": {"type": "number"},
          "canonical_url": {"type": "string", "format": "uri"}
        }
      },
      "SwarmCompanion": {
        "type": "object",
        "properties": {
          "id": {"type": "string"},
          "first_name": {"type": "string"},
          "last_name": {"type": "string"},
          "display_name": {"type": "string"}
        }
      },
      "SwarmPhoto": {
        "type": "object",
        "properties": {
          "url": {"type": "string", "format": "uri", "description": "Photo URL for rendering."},
          "width": {"type": "integer"},
          "height": {"type": "integer"}
        }
      },
      "SwarmCheckinEntry": {
        "type": "object",
        "properties": {
          "iso_time": {"type": "string", "format": "date-time"},
          "minutes_since": {"type": "integer"},
          "stale": {"type": "boolean"},
          "venue": {"$ref": "#/components/schemas/SwarmVenue"},
          "categories": {"type": "array", "items": {"type": "string"}},
          "shout": {"type": "string"},
          "companions": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/SwarmCompanion"}
          },
          "photo_count": {"type": "integer"},
          "photos": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/SwarmPhoto"}
          }
        }
      },
      "SwarmCheckinsFilters": {
        "type": "object",
        "properties": {
          "year": {"type": "integer"},
          "after_date": {"type": "string"},
          "before_date": {"type": "string"},
          "with_companion": {"type": "array", "items": {"type": "string"}},
          "only_with_companions": {"type": "boolean"},
          "category": {"type": "string"},
          "has_photos": {"type": "boolean"},
          "include_photos": {"type": "boolean"}
        }
      },
      "SwarmMyCheckinsResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "count": {"type": "integer"},
          "checkins": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/SwarmCheckinEntry"}
          },
          "filters": {"$ref": "#/components/schemas/SwarmCheckinsFilters"}
        },
        "required": ["message", "count", "checkins"]
      },
      "CurrentTimeResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "iso_time": {"type": "string", "format": "date-time"},
          "timezone": {"type": "string"},
          "offset_minutes": {"type": "integer"}
        },
        "required": ["message", "iso_time", "timezone", "offset_minutes"]
      },
      "ServerVersionResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "startup_iso_time": {"type": "string", "format": "date-time"},
          "uptime_seconds": {"type": "integer"}
        },
        "required": ["message", "startup_iso_time", "uptime_seconds"]
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "detail": {"type": "string"}
        }
      }
    },
    "securitySchemes": {
      "ActionsApiKey": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Key",
        "description": "API key for authentication."
      }
    }
  },
  "security": [{"ActionsApiKey": []}]
}

