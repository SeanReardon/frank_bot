{
  "openapi": "3.1.0",
  "info": {
    "title": "Frank Bot",
    "version": "0.5.0",
    "description": "Personal assistant for Google Calendar, Contacts, and Swarm location history."
  },
  "servers": [
    {
      "url": "http://localhost:8000"
    }
  ],
  "paths": {
    "/actions/hello": {
      "get": {
        "operationId": "sayHello",
        "summary": "Quick greeting",
        "parameters": [
          {
            "in": "query",
            "name": "name",
            "schema": {
              "type": "string"
            },
            "required": false,
            "description": "Optional name to include in the greeting."
          }
        ],
        "responses": {
          "200": {
            "description": "Greeting response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HelloWorldResponse"
                }
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/calendar/events": {
      "get": {
        "operationId": "getEvents",
        "summary": "List upcoming calendar events (read-only)",
        "parameters": [
          {
            "in": "query",
            "name": "day",
            "schema": {"type": "string"},
            "required": false,
            "description": "ISO date (YYYY-MM-DD) to list events for that day."
          },
          {
            "in": "query",
            "name": "time_min",
            "schema": {"type": "string"},
            "required": false,
            "description": "Lower bound (inclusive) in RFC3339/ISO8601 format."
          },
          {
            "in": "query",
            "name": "time_max",
            "schema": {"type": "string"},
            "required": false,
            "description": "Upper bound (exclusive) in RFC3339/ISO8601 format."
          },
          {
            "in": "query",
            "name": "max_results",
            "schema": {"type": "integer"},
            "required": false,
            "description": "Maximum events to return (1-50)."
          },
          {
            "in": "query",
            "name": "time_zone",
            "schema": {"type": "string"},
            "required": false,
            "description": "IANA timezone name."
          },
          {
            "in": "query",
            "name": "calendar_id",
            "schema": {"type": "string"},
            "required": false,
            "description": "Specific calendar ID."
          },
          {
            "in": "query",
            "name": "calendar_name",
            "schema": {"type": "string"},
            "required": false,
            "description": "Display name to resolve a calendar."
          }
        ],
        "responses": {
          "200": {
            "description": "List of calendar events.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ListCalendarEventsResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/calendar/schedule": {
      "get": {
        "operationId": "scheduleTime",
        "summary": "Add a time block to your calendar",
        "parameters": [
          {
            "in": "query",
            "name": "summary",
            "schema": {"type": "string"},
            "required": true,
            "description": "Title for the calendar entry."
          },
          {
            "in": "query",
            "name": "start",
            "schema": {"type": "string"},
            "required": true,
            "description": "Start time in ISO8601 format."
          },
          {
            "in": "query",
            "name": "end",
            "schema": {"type": "string"},
            "required": true,
            "description": "End time in ISO8601 format."
          },
          {
            "in": "query",
            "name": "description",
            "schema": {"type": "string"},
            "required": false,
            "description": "Optional notes or description."
          },
          {
            "in": "query",
            "name": "location",
            "schema": {"type": "string"},
            "required": false,
            "description": "Location or address for the event (e.g., 'Nerdvana, Frisco, TX' or '123 Main St')."
          },
          {
            "in": "query",
            "name": "attendees",
            "schema": {"type": "string"},
            "required": false,
            "description": "Comma-separated email addresses for attendees."
          },
          {
            "in": "query",
            "name": "time_zone",
            "schema": {"type": "string"},
            "required": false,
            "description": "IANA timezone (defaults to your location)."
          },
          {
            "in": "query",
            "name": "calendar_id",
            "schema": {"type": "string"},
            "required": false,
            "description": "Specific calendar ID."
          },
          {
            "in": "query",
            "name": "calendar_name",
            "schema": {"type": "string"},
            "required": false,
            "description": "Calendar name to use."
          }
        ],
        "responses": {
          "200": {
            "description": "Calendar entry details.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/CreateCalendarEventResponse"}
              }
            }
          },
          "400": {
            "description": "Invalid request.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/calendar/calendars": {
      "get": {
        "operationId": "getCalendars",
        "summary": "List available calendars (read-only)",
        "parameters": [
          {
            "in": "query",
            "name": "include_access_role",
            "schema": {"type": "boolean"},
            "required": false,
            "description": "Include accessRole metadata when true."
          },
          {
            "in": "query",
            "name": "primary_only",
            "schema": {"type": "boolean"},
            "required": false,
            "description": "Return only the primary calendar when true."
          }
        ],
        "responses": {
          "200": {
            "description": "List of calendars.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ListCalendarsResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/contacts/search": {
      "get": {
        "operationId": "searchContacts",
        "summary": "Search Google Contacts (read-only)",
        "parameters": [
          {
            "in": "query",
            "name": "query",
            "schema": {"type": "string"},
            "required": true,
            "description": "Search text (names, emails, or phone numbers)."
          },
          {
            "in": "query",
            "name": "max_results",
            "schema": {"type": "integer"},
            "required": false,
            "description": "Maximum results to return."
          }
        ],
        "responses": {
          "200": {
            "description": "Search results.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/SearchContactsResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/sms/send": {
      "get": {
        "operationId": "sendSMS",
        "summary": "Send an SMS text message to a contact",
        "description": "Send a text message to someone in your Google Contacts by name, or directly to a phone number. Messages are sent from your Telnyx phone number.",
        "parameters": [
          {
            "in": "query",
            "name": "recipient",
            "schema": {"type": "string"},
            "required": true,
            "description": "Contact name to look up in Google Contacts, or a phone number directly."
          },
          {
            "in": "query",
            "name": "message",
            "schema": {"type": "string"},
            "required": true,
            "description": "The text message content to send."
          }
        ],
        "responses": {
          "200": {
            "description": "SMS sent successfully.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/SendSMSResponse"}
              }
            }
          },
          "400": {
            "description": "Invalid request or SMS failed.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/swarm/checkins": {
      "get": {
        "operationId": "searchCheckins",
        "summary": "List your Swarm check-ins with filtering (read-only). Use to answer 'What restaurant did Jimmy and I go to in 2024?' or 'Show check-ins with Linda'.",
        "parameters": [
          {
            "in": "query",
            "name": "max_results",
            "schema": {"type": "integer"},
            "required": false,
            "description": "Number of check-ins to return (default 10, max 250)."
          },
          {
            "in": "query",
            "name": "year",
            "schema": {"type": "integer"},
            "required": false,
            "description": "Filter to check-ins from a specific year (e.g., 2024)."
          },
          {
            "in": "query",
            "name": "after_date",
            "schema": {"type": "string"},
            "required": false,
            "description": "Filter to check-ins after this date (YYYY-MM-DD)."
          },
          {
            "in": "query",
            "name": "before_date",
            "schema": {"type": "string"},
            "required": false,
            "description": "Filter to check-ins before this date (YYYY-MM-DD)."
          },
          {
            "in": "query",
            "name": "with_companion",
            "schema": {"type": "string"},
            "required": false,
            "description": "Filter to check-ins with this person (name). Comma-separate for multiple (e.g., 'lauren, ekaterina'). Uses fuzzy matching for typos."
          },
          {
            "in": "query",
            "name": "companion_match",
            "schema": {"type": "string", "enum": ["any", "all"]},
            "required": false,
            "description": "'any' (default) = OR, matches if ANY companion present; 'all' = AND, requires ALL companions."
          },
          {
            "in": "query",
            "name": "only_with_companions",
            "schema": {"type": "boolean"},
            "required": false,
            "description": "If true, only return check-ins where you were with someone."
          },
          {
            "in": "query",
            "name": "category",
            "schema": {"type": "string"},
            "required": false,
            "description": "Filter by venue category (e.g., 'restaurant', 'coffee', 'bar')."
          },
          {
            "in": "query",
            "name": "has_photos",
            "schema": {"type": "boolean"},
            "required": false,
            "description": "If true, only return check-ins that have photos."
          },
          {
            "in": "query",
            "name": "include_photos",
            "schema": {"type": "boolean"},
            "required": false,
            "description": "If true, include photo URLs in the response for rendering."
          }
        ],
        "responses": {
          "200": {
            "description": "Your Swarm check-ins matching the filters.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/SwarmMyCheckinsResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/me/time": {
      "get": {
        "operationId": "getTime",
        "summary": "Get current local time based on your location (read-only)",
        "responses": {
          "200": {
            "description": "Current local time information.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/CurrentTimeResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/ups/status": {
      "get": {
        "operationId": "getUpsStatus",
        "summary": "Get home UPS status (read-only)",
        "responses": {
          "200": {
            "description": "Home UPS runtime, charge, and temperature.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/UpsStatusResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/server/status": {
      "get": {
        "operationId": "getServerStatus",
        "summary": "Get server uptime info (read-only)",
        "responses": {
          "200": {
            "description": "Server start time and uptime.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ServerVersionResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/actions/server/diagnostics": {
      "get": {
        "operationId": "getDiagnostics",
        "summary": "Get service diagnostics and performance stats (read-only)",
        "responses": {
          "200": {
            "description": "Comprehensive diagnostics including API stats, latency, and error logs.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/DiagnosticsResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/frank/meta": {
      "get": {
        "operationId": "getFrankMeta",
        "summary": "Get FrankAPI documentation for script development",
        "description": "Returns Markdown documentation describing the FrankAPI scripting interface, including all available namespaces (calendar, contacts, sms, swarm, ups, time) and their methods.",
        "responses": {
          "200": {
            "description": "FrankAPI documentation in Markdown format.",
            "content": {
              "text/markdown": {
                "schema": {"type": "string"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/frank/scripts": {
      "get": {
        "operationId": "listFrankScripts",
        "summary": "List all saved scripts",
        "description": "Returns metadata for all saved scripts, including ID, slug, description, parameters, and creation time.",
        "responses": {
          "200": {
            "description": "List of saved scripts.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ListScriptsResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/frank/scripts/{script_id}": {
      "get": {
        "operationId": "getFrankScript",
        "summary": "Get a script's source code",
        "parameters": [
          {
            "in": "path",
            "name": "script_id",
            "schema": {"type": "string"},
            "required": true,
            "description": "The script ID (filename without .py extension)."
          }
        ],
        "responses": {
          "200": {
            "description": "Script source code.",
            "content": {
              "text/x-python": {
                "schema": {"type": "string"}
              }
            }
          },
          "404": {
            "description": "Script not found.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/frank/execute": {
      "post": {
        "operationId": "executeFrankScript",
        "summary": "Execute a script",
        "description": "Execute a new or existing script. For new scripts, provide slug and code. For existing scripts, provide script_id. Returns immediately with a job ID; poll /frank/jobs/{id} for completion.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {"$ref": "#/components/schemas/ExecuteScriptRequest"}
            }
          }
        },
        "responses": {
          "200": {
            "description": "Job created successfully.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ExecuteScriptResponse"}
              }
            }
          },
          "400": {
            "description": "Invalid request (missing required fields).",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          },
          "404": {
            "description": "Script not found (when using script_id).",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/frank/jobs": {
      "get": {
        "operationId": "listFrankJobs",
        "summary": "List all job executions",
        "parameters": [
          {
            "in": "query",
            "name": "status",
            "schema": {"type": "string", "enum": ["pending", "running", "completed", "failed", "timeout"]},
            "required": false,
            "description": "Filter by job status."
          }
        ],
        "responses": {
          "200": {
            "description": "List of job summaries.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ListJobsResponse"}
              }
            }
          },
          "400": {
            "description": "Invalid status filter.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    },
    "/frank/jobs/{job_id}": {
      "get": {
        "operationId": "getFrankJob",
        "summary": "Get job details",
        "description": "Get full details for a job execution, including stdout, stderr, result, and error information.",
        "parameters": [
          {
            "in": "path",
            "name": "job_id",
            "schema": {"type": "string"},
            "required": true,
            "description": "The job ID."
          }
        ],
        "responses": {
          "200": {
            "description": "Job details.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/JobDetails"}
              }
            }
          },
          "404": {
            "description": "Job not found.",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        },
        "security": [{"ActionsApiKey": []}]
      }
    }
  },
  "components": {
    "schemas": {
      "HelloWorldResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "name": {"type": "string"}
        },
        "required": ["message", "name"]
      },
      "CalendarDescriptor": {
        "type": "object",
        "properties": {
          "id": {"type": "string"},
          "label": {"type": "string"}
        }
      },
      "TimeWindow": {
        "type": "object",
        "properties": {
          "time_min": {"type": "string"},
          "time_max": {"type": "string"},
          "time_zone": {"type": "string"}
        }
      },
      "CalendarEvent": {
        "type": "object",
        "description": "Google Calendar event.",
        "properties": {
          "id": {"type": "string"},
          "summary": {"type": "string"},
          "description": {"type": "string"},
          "location": {"type": "string"},
          "htmlLink": {"type": "string", "format": "uri"},
          "start": {"type": "object", "additionalProperties": true},
          "end": {"type": "object", "additionalProperties": true},
          "attendees": {
            "type": "array",
            "items": {"type": "object", "additionalProperties": true}
          }
        },
        "additionalProperties": true
      },
      "ListCalendarEventsResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "calendar": {"$ref": "#/components/schemas/CalendarDescriptor"},
          "time_window": {"$ref": "#/components/schemas/TimeWindow"},
          "count": {"type": "integer"},
          "events": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/CalendarEvent"}
          }
        },
        "required": ["message", "calendar", "time_window", "count", "events"]
      },
      "CreateCalendarEventRequest": {
        "type": "object",
        "properties": {
          "summary": {"type": "string"},
          "start": {"type": "string", "description": "Start time in ISO8601 format."},
          "end": {"type": "string", "description": "End time in ISO8601 format."},
          "attendees": {
            "type": "array",
            "items": {"type": "string"},
            "description": "Email addresses for attendees."
          },
          "description": {"type": "string"},
          "location": {"type": "string", "description": "Location or address for the event."},
          "time_zone": {"type": "string"},
          "calendar_id": {"type": "string"},
          "calendar_name": {"type": "string"}
        },
        "required": ["summary", "start", "end"]
      },
      "CreateCalendarEventResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "calendar": {"$ref": "#/components/schemas/CalendarDescriptor"},
          "event": {"$ref": "#/components/schemas/CalendarEvent"}
        },
        "required": ["message", "calendar", "event"]
      },
      "CalendarSummary": {
        "type": "object",
        "properties": {
          "id": {"type": "string"},
          "summary": {"type": "string"},
          "timeZone": {"type": "string"},
          "primary": {"type": "boolean"},
          "accessRole": {"type": "string"}
        }
      },
      "ListCalendarsResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "count": {"type": "integer"},
          "calendars": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/CalendarSummary"}
          }
        },
        "required": ["message", "count", "calendars"]
      },
      "ContactResult": {
        "type": "object",
        "properties": {
          "resource_name": {"type": "string"},
          "display_name": {"type": "string"},
          "emails": {"type": "array", "items": {"type": "string"}},
          "phones": {"type": "array", "items": {"type": "string"}}
        }
      },
      "SearchContactsResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "query": {"type": "string"},
          "count": {"type": "integer"},
          "contacts": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/ContactResult"}
          }
        },
        "required": ["message", "query", "count", "contacts"]
      },
      "SendSMSResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string", "description": "Human-readable summary of the action."},
          "success": {"type": "boolean"},
          "recipient": {"type": "string", "description": "Contact name or phone number."},
          "to_number": {"type": "string", "description": "The phone number the SMS was sent to."},
          "from_number": {"type": "string", "description": "The Telnyx phone number used to send."},
          "message_id": {"type": "string", "description": "Telnyx message ID for tracking."},
          "text_preview": {"type": "string", "description": "Preview of the message text sent."}
        },
        "required": ["message", "success", "recipient", "to_number", "from_number"]
      },
      "SwarmVenue": {
        "type": "object",
        "properties": {
          "name": {"type": "string"},
          "city": {"type": "string"},
          "state": {"type": "string"},
          "country": {"type": "string"},
          "latitude": {"type": "number"},
          "longitude": {"type": "number"},
          "canonical_url": {"type": "string", "format": "uri"}
        }
      },
      "SwarmCompanion": {
        "type": "object",
        "properties": {
          "id": {"type": "string"},
          "first_name": {"type": "string"},
          "last_name": {"type": "string"},
          "display_name": {"type": "string"}
        }
      },
      "SwarmPhoto": {
        "type": "object",
        "properties": {
          "url": {"type": "string", "format": "uri", "description": "Photo URL for rendering."},
          "width": {"type": "integer"},
          "height": {"type": "integer"}
        }
      },
      "SwarmCheckinEntry": {
        "type": "object",
        "properties": {
          "iso_time": {"type": "string", "format": "date-time"},
          "minutes_since": {"type": "integer"},
          "stale": {"type": "boolean"},
          "venue": {"$ref": "#/components/schemas/SwarmVenue"},
          "categories": {"type": "array", "items": {"type": "string"}},
          "shout": {"type": "string"},
          "companions": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/SwarmCompanion"}
          },
          "photo_count": {"type": "integer"},
          "photos": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/SwarmPhoto"}
          }
        }
      },
      "SwarmCheckinsFilters": {
        "type": "object",
        "properties": {
          "year": {"type": "integer"},
          "after_date": {"type": "string"},
          "before_date": {"type": "string"},
          "with_companion": {"type": "array", "items": {"type": "string"}},
          "only_with_companions": {"type": "boolean"},
          "category": {"type": "string"},
          "has_photos": {"type": "boolean"},
          "include_photos": {"type": "boolean"}
        }
      },
      "SwarmMyCheckinsResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "count": {"type": "integer"},
          "checkins": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/SwarmCheckinEntry"}
          },
          "filters": {"$ref": "#/components/schemas/SwarmCheckinsFilters"}
        },
        "required": ["message", "count", "checkins"]
      },
      "CurrentTimeResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "iso_time": {"type": "string", "format": "date-time"},
          "timezone": {"type": "string"},
          "offset_minutes": {"type": "integer"}
        },
        "required": ["message", "iso_time", "timezone", "offset_minutes"]
      },
      "UpsRuntime": {
        "type": "object",
        "properties": {
          "hours": {"type": "integer", "minimum": 0},
          "mins": {"type": "integer", "minimum": 0, "maximum": 59},
          "human": {"type": "string", "description": "Human-readable runtime, e.g. '1h 22m'."}
        },
        "required": ["hours", "mins", "human"]
      },
      "UpsStatusResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "runtime": {"$ref": "#/components/schemas/UpsRuntime"},
          "charge_percent": {"type": "integer", "minimum": 0, "maximum": 100},
          "temperature_f": {"type": "number"}
        },
        "required": ["message", "runtime", "charge_percent", "temperature_f"]
      },
      "ServerVersionResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "startup_iso_time": {"type": "string", "format": "date-time"},
          "uptime_seconds": {"type": "integer"}
        },
        "required": ["message", "startup_iso_time", "uptime_seconds"]
      },
      "DiagnosticsResponse": {
        "type": "object",
        "properties": {
          "message": {"type": "string"},
          "server": {
            "type": "object",
            "properties": {
              "start_time": {"type": "string", "format": "date-time"},
              "current_time": {"type": "string", "format": "date-time"},
              "uptime_seconds": {"type": "integer"},
              "uptime_human": {"type": "string"}
            }
          },
          "interactions": {
            "type": "object",
            "properties": {
              "total_api_calls": {"type": "integer"},
              "by_endpoint": {"type": "array", "items": {"type": "object"}}
            }
          },
          "services": {"type": "object", "additionalProperties": true},
          "system": {
            "type": "object",
            "properties": {
              "python_version": {"type": "string"},
              "platform": {"type": "string"}
            }
          },
          "recent_errors": {"type": "array", "items": {"type": "object"}}
        },
        "required": ["message", "server", "interactions"]
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "detail": {"type": "string"}
        }
      },
      "ScriptParameter": {
        "type": "object",
        "properties": {
          "name": {"type": "string"},
          "type": {"type": "string"},
          "description": {"type": "string"}
        },
        "required": ["name", "description"]
      },
      "ScriptMetadata": {
        "type": "object",
        "properties": {
          "id": {"type": "string", "description": "Script ID (filename without .py)."},
          "slug": {"type": "string", "description": "Script slug."},
          "description": {"type": "string", "description": "Script description from docstring."},
          "parameters": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/ScriptParameter"}
          },
          "example": {"type": "string", "description": "Example usage from docstring."},
          "created_at": {"type": "string", "format": "date-time"}
        },
        "required": ["id", "slug", "description", "parameters", "created_at"]
      },
      "ListScriptsResponse": {
        "type": "object",
        "properties": {
          "count": {"type": "integer"},
          "scripts": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/ScriptMetadata"}
          }
        },
        "required": ["count", "scripts"]
      },
      "ExecuteScriptRequest": {
        "type": "object",
        "properties": {
          "script_id": {"type": "string", "description": "ID of existing script to execute."},
          "slug": {"type": "string", "description": "Slug for new script (required with code)."},
          "code": {"type": "string", "description": "Python source code for new script."},
          "params": {
            "type": "object",
            "additionalProperties": true,
            "description": "Parameters to pass to the script's main() function."
          }
        },
        "description": "Either script_id OR both slug and code are required."
      },
      "ExecuteScriptResponse": {
        "type": "object",
        "properties": {
          "job_id": {"type": "string", "description": "Unique job identifier for polling."},
          "script_id": {"type": "string", "description": "ID of the executed script."},
          "status": {"type": "string", "enum": ["pending", "running"], "description": "Initial job status."},
          "started_at": {"type": "string", "format": "date-time"}
        },
        "required": ["job_id", "script_id", "status"]
      },
      "JobSummary": {
        "type": "object",
        "properties": {
          "job_id": {"type": "string"},
          "script_id": {"type": "string"},
          "status": {"type": "string", "enum": ["pending", "running", "completed", "failed", "timeout"]},
          "started_at": {"type": "string", "format": "date-time"},
          "completed_at": {"type": "string", "format": "date-time"}
        },
        "required": ["job_id", "script_id", "status"]
      },
      "ListJobsResponse": {
        "type": "object",
        "properties": {
          "count": {"type": "integer"},
          "jobs": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/JobSummary"}
          }
        },
        "required": ["count", "jobs"]
      },
      "JobDetails": {
        "type": "object",
        "properties": {
          "job_id": {"type": "string"},
          "script_id": {"type": "string"},
          "status": {"type": "string", "enum": ["pending", "running", "completed", "failed", "timeout"]},
          "params": {"type": "object", "additionalProperties": true},
          "started_at": {"type": "string", "format": "date-time"},
          "completed_at": {"type": "string", "format": "date-time"},
          "stdout": {"type": "string", "description": "Captured standard output."},
          "stderr": {"type": "string", "description": "Captured standard error."},
          "result": {"description": "Return value from main() function."},
          "error": {"type": "string", "description": "Error message if status is failed or timeout."}
        },
        "required": ["job_id", "script_id", "status", "params", "stdout", "stderr"]
      }
    },
    "securitySchemes": {
      "ActionsApiKey": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Key",
        "description": "API key for authentication."
      }
    }
  },
  "security": [{"ActionsApiKey": []}]
}

